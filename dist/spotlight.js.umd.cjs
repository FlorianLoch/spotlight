(function(c,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(c=typeof globalThis<"u"?globalThis:c||self,h(c.Spotlight={}))})(this,function(c){"use strict";function h(e,t){e.classList.add(t)}function L(e,t){e.classList.remove(t)}function _e(e,t,n){n?h(e,t):L(e,t)}function Xt(e){for(var t in e)t.startsWith("_s_")&&e.style.setProperty(t.substring(3),e[t])}function f(e,t,n){n=""+n,e["_s_"+t]!==n&&(e.style.setProperty(t,n),e["_s_"+t]=n)}let ut=0;function he(e,t){t&&(f(e,"transition","none"),t()),ut||(ut=e.clientTop&&0),t&&f(e,"transition","")}function me(e,t){e.firstChild.nodeValue=t}function dt(e,t){return(t||document).getElementsByClassName(e)}function y(e,t,n,o){Q(!0,e,t,n,o)}function Q(e,t,n,o,s){t[(e?"add":"remove")+"EventListener"](n,o,s||s===!1?s:!0)}function ge(e,t){e.stopPropagation(),t&&e.preventDefault()}function Ft(e,t){const n=A("a"),o=t.src;n.href=o,n.download=o.substring(o.lastIndexOf("/")+1),e.appendChild(n),n.click(),e.removeChild(n)}function A(e){return document.createElement(e)}function Z(e,t){f(e,"display",t?"":"none")}function $(e,t){f(e,"visibility",t?"":"hidden")}function P(e,t){f(e,"transition",t?"":"none")}const ee=["info","theme","download","play","page","close","autofit","zoom-in","zoom-out","prev","next","fullscreen"],It={info:1,page:1,close:1,autofit:1,"zoom-in":1,"zoom-out":1,prev:1,next:1,fullscreen:1},b={BACKSPACE:8,ESCAPE:27,SPACEBAR:32,LEFT:37,RIGHT:39,UP:38,NUMBLOCK_PLUS:107,PLUS:187,DOWN:40,NUMBLOCK_MINUS:109,MINUS:189,INFO:73},u=A("div");u.id="spotlight",u.innerHTML="<div class=spl-spinner></div><div class=spl-track><div class=spl-scene><div class=spl-pane></div></div></div><div class=spl-header><div class=spl-page> </div></div><div class=spl-progress></div><div class=spl-footer><div class=spl-title> </div><div class=spl-description> </div><div class=spl-button> </div></div><div class=spl-prev></div><div class=spl-next></div>";const Fe={},Yt=A("video");function pt(e,t,n,o){let s,l;if(o!=="node"){const v=Object.keys(n);for(let ft=0,z;ft<v.length;ft++)if(z=v[ft],z.length>3&&z.indexOf("src")===0)if(o==="video"){const pe=Fe[z];if(pe){if(pe>0){s=n[z];break}}else if(Yt.canPlayType("video/"+z.substring(3).replace("-","").toLowerCase())){Fe[z]=1,s=n[z];break}else Fe[z]=-1}else{const pe=parseInt(z.substring(4),10);if(pe){const Ut=Math.abs(t-pe);(!l||Ut<l)&&(l=Ut,s=n[z])}}}return s||n.src||n.href||e.src||e.href}const te={},_t=navigator.connection,Bt=window.devicePixelRatio||1,ht="spotlightjs";let d,p,Y,B,M,R,Ie,Ye,S,q,ve,ne,ye,H,ie,O,a,w,N,r,Be,be,U,mt,we,Ce,ke,Re,ze,x,Se,qe,He,Ee,D,oe,xe,Te,Le,De,j,C,_,se,i,je=A("img"),le,Ke,K,re=!1,We,Ge,Pe,Ve,Je,Qe,gt,vt,W,Me,X,G,g,k,Ze,E,yt;y(document,"click",qt);function bt(){if(C)return;C=document.body,le=t("scene"),Ke=t("header"),K=t("footer"),We=t("title"),Ge=t("description"),Pe=t("button"),Ve=t("prev"),Je=t("next"),gt=t("page"),W=t("progress"),Me=t("spinner"),se=[t("pane")],T("close",I),C[E="requestFullscreen"]||C[E="msRequestFullscreen"]||C[E="webkitRequestFullscreen"]||C[E="mozRequestFullscreen"]||(E=""),E?(yt=E.replace("request","exit").replace("mozRequest","mozCancel").replace("Request","Exit"),Qe=T("fullscreen",ot)):ee.pop(),T("info",at),T("autofit",Oe),T("zoom-in",lt),T("zoom-out",rt),T("theme",Ae),vt=T("play",V),T("download",At),y(Ve,"click",Xe),y(Je,"click",ue);const e=t("track");y(e,"mousedown",Lt),y(e,"mousemove",Mt),y(e,"mouseleave",it),y(e,"mouseup",it),y(e,"touchstart",Lt,{passive:!1}),y(e,"touchmove",Mt,{passive:!0}),y(e,"touchend",it),y(Pe,"click",function(){Ee?Ee(a,r):He&&(location.href=He)});function t(n){return te[n]=dt("spl-"+n,u)[0]}}function T(e,t){const n=A("div");return n.className="spl-"+e,y(n,"click",t),Ke.appendChild(n),te[e]=n}function Rt(e){const t=te[e];t&&(Ke.removeChild(t),te[e]=null)}function qt(e){if(H)return;const t=e.target.closest(".spotlight");if(t){ge(e,!0);const n=t.closest(".spotlight-group");N=dt("spotlight",n);for(let o=0;o<N.length;o++)if(N[o]===t){be=n&&Object.assign({},n.dataset,$e(n)),wt(o+1);break}}}function Ht(e,t,n){N=e,t&&(be=t,we=t.onshow,Ce=t.onchange,ke=t.onclose,n=n||t.index),wt(n)}function wt(e){if(w=N.length,w){C||bt(),we&&we(e);const t=se[0],n=t.parentNode;for(let o=se.length;o<w;o++){const s=t.cloneNode(!1);f(s,"left",o*100+"%"),n.appendChild(s),se[o]=s}_||(C.appendChild(u),tt()),a=e||1,P(le),Ot(!0),E&&kt(),Jt()}}function m(e,t){const n=r[e];if(n!==void 0){const o=String(n);return o!=="false"&&(o||t)}return t}function $e(e){const t={};for(const n in e.dataset)if(n.startsWith(ht)){let o=n.substring(ht.length);if(o.length===0)continue;o=o[0].toLowerCase()+o.substring(1),t[o]=e.dataset[n]}return t}function xt(e){r=Object.assign({},be,e.dataset||e,$e(e)),Be=r.media,Ee=r.onclick,Se=r.theme,D=r.class,ze=m("autohide",!0),U=m("infinite"),mt=m("progress",!0),x=m("autoslide"),qe=m("preload",!0),He=r.buttonHref,xe=x&&parseFloat(x)||7,O||Se&&Ae(Se),D&&h(u,D),D&&he(u),oe=m("closeAfterLast",!1);const t=r.control;if(t){const o=typeof t=="string"?t.split(","):t;for(let s=0;s<ee.length;s++)r[ee[s]]=!1;for(let s=0;s<o.length;s++){const l=o[s].trim();l==="zoom"?r["zoom-in"]=r["zoom-out"]=!0:r[l]=!0}}const n=r.animation;if(Te=Le=De=!n,j=!1,n){const o=typeof n=="string"?n.split(","):n;for(let s=0;s<o.length;s++){const l=o[s].trim();l==="scale"?Te=!0:l==="fade"?Le=!0:l==="slide"?De=!0:l&&(j=l)}}Re=r.fit}function et(e){e?he(i,et):(P(le,De),f(i,"opacity",Le?0:1),zt(Te&&.8),j&&h(i,j))}function Ne(e){if(_=se[e-1],i=_.firstChild,a=e,i)Nt(),Re&&h(i,Re),et(!0),j&&L(i,j),Le&&f(i,"opacity",1),Te&&f(i,"transform",""),f(i,"visibility","visible"),G&&(je.src=G),x&&nt(g);else{const t=X.media,n=m("spinner",!0);if(t==="video")ce(n,!0),i=A("video"),i.onloadedmetadata=function(){i===this&&(i.onerror=null,i.width=i.videoWidth,i.height=i.videoHeight,ae(),ce(n),Ne(e))},i.poster=r.poster,i.preload=qe?"auto":"metadata",i.controls=m("controls",!0),i.autoplay=r.autoplay,i.playsinline=m("inline"),i.muted=m("muted"),i.src=X.src,_.appendChild(i);else if(t==="node"){i=X.src,typeof i=="string"&&(i=document.querySelector(i)),i&&(i._root||(i._root=i.parentNode),i._style||(i._style=i.getAttribute("style")),Xt(i),ae(),_.appendChild(i),Ne(e));return}else ce(n,!0),i=A("img"),i.onload=function(){i===this&&(i.onerror=null,ce(n),Ne(e),ae())},i.src=X.src,_.appendChild(i);i&&(n||f(i,"visibility","visible"),i.onerror=function(){i===this&&(Ue(i),h(Me,"error"),ce(n))})}}function ce(e,t){e&&_e(Me,"spin",t)}function Ct(){return document.fullscreen||document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement}function Dt(){if(tt(),i&&ae(),E){const e=Ct();_e(Qe,"on",e),e||kt()}}function kt(){Z(Qe,screen.availHeight-window.innerHeight>0)}function tt(){M=u.clientWidth,R=u.clientHeight}function ae(){Ie=i.clientWidth,Ye=i.clientHeight}function zt(e){f(i,"transform","translate(-50%, -50%) scale("+(e||S)+")")}function F(e,t){f(_,"transform",e||t?"translate("+e+"px, "+t+"px)":"")}function fe(e,t,n){t?he(le,function(){fe(e,!1,n)}):f(le,"transform","translateX("+(-e*100+(n||0))+"%)")}function St(e){Q(e,window,"keydown",Kt),Q(e,window,"wheel",Wt),Q(e,window,"resize",Dt),Q(e,window,"popstate",jt)}function jt(e){_&&e.state.spl&&I(!0)}function Kt(e){if(_){const t=r["zoom-in"]!==!1;switch(e.keyCode){case b.BACKSPACE:t&&Oe();break;case b.ESCAPE:I();break;case b.SPACEBAR:x&&V();break;case b.LEFT:Xe();break;case b.RIGHT:ue();break;case b.UP:case b.NUMBLOCK_PLUS:case b.PLUS:t&&lt();break;case b.DOWN:case b.NUMBLOCK_MINUS:case b.MINUS:t&&rt();break;case b.INFO:at();break}}}function Wt(e){if(_&&r["zoom-in"]!==!1){let t=e.deltaY;t=(t<0?1:t?-1:0)*.5,t<0?rt(e,e.clientX,e.clientY):t>0&&lt(e,e.clientX,e.clientY)}}function V(e,t){(typeof e=="boolean"?e:!g)===!g&&(g=g?clearTimeout(g):1,_e(vt,"on",g),t||nt(g))}function nt(e){mt&&(he(W,function(){f(W,"transition-duration",""),f(W,"transform","")}),e&&(f(W,"transition-duration",xe+"s"),f(W,"transform","translateX(0)"))),e&&(g=setTimeout(ue,xe*1e3))}function J(){ze&&(Ze=Date.now()+2950,k||(h(u,"menu"),Et(3e3)))}function Et(e){k=setTimeout(function(){const t=Date.now();t>=Ze?(L(u,"menu"),k=0):Et(Ze-t)},e)}function Tt(e){typeof e=="boolean"&&(k=e?k:0),k?(k=clearTimeout(k),L(u,"menu")):J()}function Lt(e){ge(e,!0),ve=!0,ne=!1,H=!1;let t=e,n=e.touches;q=n,n&&(n=n[0])&&(t=n),ye=Ie*S<=M&&Ye*S<=R,Y=t.pageX,B=t.pageY,P(_)}function it(e){if(ge(e),q=null,ve){if(!ne)Tt();else{if(ye&&ne){const t=d<-(M/7)&&(a<w||U||oe),n=t||d>M/7&&(a>1||U||oe);(t||n)&&(fe(a-1,!0,d/M*100),t&&ue()||n&&Xe()),H&&p<-(R/4)?I():(d=0,p=0),F()}P(_,!0)}ve=!1}}function Pt(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function Gt(e){return[(e[0].clientX+e[1].clientX)*.5,(e[0].clientY+e[1].clientY)*.5]}function Vt(e){if(r["zoom-in"]!==!1&&e&&e.length===2&&q&&q.length===2){const t=Pt(e)/Pt(q),n=Gt(e);st(t,n[0],n[1],!1)}return q=e,e&&e[0]}function Mt(e){if(ge(e),ve){let t=Vt(e.touches);if(t&&(e=t),!ne){const n=Y-e.pageX,o=B-e.pageY;H=ye&&o>Math.abs(n)*1.15}if(H)p-=B-(B=e.pageY);else if(ye)d-=Y-(Y=e.pageX);else{let n=(Ie*S-M)/2,o=Math.abs(n);n>0&&(d-=Y-(Y=e.pageX)),d>o?d=o:d<-o&&(d=-o),n=(Ye*S-R)/2,o=Math.abs(n),n>0&&(p-=B-(B=e.pageY)),p>o?p=o:p<-o&&(p=-o)}ne=!0,F(d,p)}else J()}function ot(e){const t=Ct();(typeof e!="boolean"||e!==!!t)&&(t?document[yt]():u[E]())}function Ae(e){typeof e!="string"&&(e=O?"":Se||"white"),O!==e&&(O&&L(u,O),e&&h(u,e),O=e)}function Oe(e){typeof e=="boolean"&&(ie=!e),ie=S===1&&!ie,_e(i,"autofit",ie),f(i,"transform",""),S=1,d=0,p=0,ae(),P(_),F()}function st(e,t,n,o){let s=S*e;if(P(_,o),P(i,o),Nt(),s<=1){d=p=0,F(d,p),ct(1);return}if(!(s>50)){if(n){const l=M/2,v=R/2;d=t-(t-d-l)*e-l,p=n-(n-p-v)*e-v}else d*=e,p*=e;F(d,p),ct(s)}}function lt(e,t,n){st(1/.65,t,n,!0)}function rt(e,t,n){st(.65,t,n,!0)}function ct(e){S=e||1,zt()}function at(){re=!re,$(K,re)}function Nt(){ie&&Oe()}function Jt(){history.pushState({spl:1},""),history.pushState({spl:2},""),P(u,!0),h(C,"hide-scrollbars"),h(u,"show"),St(!0),tt(),J(),x&&V(!0,!0)}function At(){Ft(C,i)}function I(e){setTimeout(function(){C.removeChild(u),_=i=X=r=be=N=we=Ce=ke=Ee=null,H=!1},200),L(C,"hide-scrollbars"),L(u,"show"),ot(!1),St(),history.go(e===!0?-1:-2),G&&(je.src=""),g&&V(),i&&Ue(i),k&&(k=clearTimeout(k)),O&&Ae(),D&&L(u,D),ke&&ke()}function Ue(e){if(e._root)e.setAttribute("style",e._style||""),e._root.appendChild(e),e._root=e._style=null;else{const t=e.parentNode;t&&t.removeChild(e),e.onerror=null,e.src=""}}function Xe(e){if(e&&J(),w>1){if(a>1)return de(a-1);if(U)return fe(w,!0),de(w);oe&&I()}}function ue(e){if(e&&J(),w>1){if(a<w)return de(a+1);if(U)return fe(-1,!0),de(1);g?V():oe&&I()}}function de(e){if(e!==a){g?(clearTimeout(g),nt()):J();const t=e>a;return a=e,Ot(t),!0}}function Qt(e){let t=N[a-1];xt(t);const n=_t&&_t.downlink;let o=Math.max(R,M)*Bt;n&&n*1200<o&&(o=n*1200);let s;if(X={media:Be,src:pt(t,o,r,Be),title:m("title",t.alt||t.title||(s=t.firstElementChild)&&(s.alt||s.title))},G&&(je.src=G=""),qe&&e&&(t=N[a])){const l=Object.assign({},t.dataset||t,$e(t)),v=l.media;(!v||v==="image")&&(G=pt(t,o,l,v))}for(let l=0;l<ee.length;l++){const v=ee[l];Z(te[v],m(v,It[v]))}}function Ot(e){if(d=0,p=0,S=1,i)if(i.onerror)Ue(i);else{let l=i;setTimeout(function(){l&&i!==l&&(Ue(l),l=null)},650),et(),F()}K&&$(K,!1),Qt(e),fe(a-1),L(Me,"error"),Ne(a),P(_),F();const t=X.title,n=m("description"),o=m("button"),s=t||n||o;s&&(t&&me(We,t),n&&me(Ge,n),o&&me(Pe,o),Z(We,t),Z(Ge,n),Z(Pe,o),f(K,"transform",ze==="all"?"":"none")),ze||h(u,"menu"),re=s,$(K,re),$(Ve,U||a>1),$(Je,U||a<w),me(gt,w>1?a+" / "+w:""),Ce&&Ce(a,r)}c.addControl=T,c.autofit=Oe,c.close=I,c.download=At,c.fullscreen=ot,c.goto=de,c.info=at,c.init=bt,c.menu=Tt,c.next=ue,c.play=V,c.prev=Xe,c.removeControl=Rt,c.show=Ht,c.theme=Ae,c.zoom=ct,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
